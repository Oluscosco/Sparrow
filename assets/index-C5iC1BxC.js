import{c as e,j as t,T as r,a as s,u as a,i as n,C as o,P as i,b as l,B as c,d,G as h,F as x,e as u,f as p,A as m,D as j,g as f,h as g,k as v,I as b,l as y,m as k,n as w,o as S,S as C,p as M,q as z,r as P,s as _,M as O,t as I,L as $,v as F,w as E,x as A,y as H,z as D,E as T,H as W,J as L,K as V,N as B,O as R,Q as N,R as G,U as q,V as J,W as U,X as Y,Y as K,Z as Q,_ as X,$ as Z,a0 as ee,a1 as te,a2 as re,a3 as se,a4 as ae,a5 as ne,a6 as oe,a7 as ie}from"./mui-C9n1924D.js";import{c as le,r as ce,a as de,g as he,u as xe,d as ue,B as pe,e as me,f as je}from"./vendor-C4GPG6ag.js";var fe;!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var ge=le;fe=ge.createRoot,ge.hydrateRoot;const ve=ce.createContext(null);function be({clientId:e,nonce:t,onScriptLoadSuccess:r,onScriptLoadError:s,children:a}){const n=function(e={}){const{nonce:t,onScriptLoadSuccess:r,onScriptLoadError:s}=e,[a,n]=ce.useState(!1),o=ce.useRef(r);o.current=r;const i=ce.useRef(s);return i.current=s,ce.useEffect((()=>{const e=document.createElement("script");return e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,e.nonce=t,e.onload=()=>{var e;n(!0),null===(e=o.current)||void 0===e||e.call(o)},e.onerror=()=>{var e;n(!1),null===(e=i.current)||void 0===e||e.call(i)},document.body.appendChild(e),()=>{document.body.removeChild(e)}}),[t]),a}({nonce:t,onScriptLoadSuccess:r,onScriptLoadError:s}),o=ce.useMemo((()=>({clientId:e,scriptLoadedSuccessfully:n})),[e,n]);return de.createElement(ve.Provider,{value:o},a)}const ye={theme:"light",compactMode:!1,animations:!0,autoSave:!0,offlineMode:!1,keyboardShortcuts:!0,notifications:{enabled:!0,sound:!0,desktop:!1}},ke=ce.createContext(void 0);function we({children:a}){const[n,o]=ce.useState((()=>{const e=localStorage.getItem("appSettings");return e?JSON.parse(e):ye}));ce.useEffect((()=>{localStorage.setItem("appSettings",JSON.stringify(n))}),[n]);const i=e({palette:{mode:n.theme,primary:{main:"#1976d2",light:"#42a5f5",dark:"#1565c0"},secondary:{main:"#9c27b0",light:"#ba68c8",dark:"#7b1fa2"},background:{default:"light"===n.theme?"#f5f5f5":"#121212",paper:"light"===n.theme?"#ffffff":"#1e1e1e"},text:{primary:"light"===n.theme?"rgba(0, 0, 0, 0.87)":"rgba(255, 255, 255, 0.87)",secondary:"light"===n.theme?"rgba(0, 0, 0, 0.6)":"rgba(255, 255, 255, 0.6)"},divider:"light"===n.theme?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)"},components:{MuiPaper:{styleOverrides:{root:{backgroundImage:"none",borderRadius:n.compactMode?4:8,background:e=>s(e.palette.background.paper,.9),backdropFilter:"blur(10px)"}}},MuiButton:{styleOverrides:{root:{borderRadius:n.compactMode?4:8,padding:n.compactMode?"6px 12px":"8px 16px",textTransform:"none"},contained:{boxShadow:"none","&:hover":{boxShadow:e=>`0 2px 4px ${s(e.palette.primary.main,.2)}`}}}},MuiCard:{styleOverrides:{root:{borderRadius:n.compactMode?4:8,background:e=>s(e.palette.background.paper,.9),backdropFilter:"blur(10px)",border:e=>`1px solid ${s(e.palette.divider,.1)}`}}},MuiAppBar:{styleOverrides:{root:{background:e=>s(e.palette.background.paper,.9),backdropFilter:"blur(10px)",borderBottom:e=>`1px solid ${s(e.palette.divider,.1)}`}}},MuiDrawer:{styleOverrides:{paper:{background:e=>s(e.palette.background.paper,.9),backdropFilter:"blur(10px)"}}},MuiDialog:{styleOverrides:{paper:{background:e=>s(e.palette.background.paper,.9),backdropFilter:"blur(10px)"}}},MuiChip:{styleOverrides:{root:{background:e=>s(e.palette.background.paper,.8),border:e=>`1px solid ${s(e.palette.divider,.1)}`}}}},typography:{fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif',h1:{fontWeight:600},h2:{fontWeight:600},h3:{fontWeight:600},h4:{fontWeight:600},h5:{fontWeight:600},h6:{fontWeight:600}},shape:{borderRadius:n.compactMode?4:8}});return t.jsx(ke.Provider,{value:{settings:n,updateSettings:e=>{o((t=>({...t,...e})))},theme:i},children:t.jsx(r,{theme:i,children:a})})}function Se(){const e=ce.useContext(ke);if(void 0===e)throw new Error("useSettings must be used within a SettingsProvider");return e}var Ce={},Me={};const ze=he(a);var Pe;function _e(){return Pe||(Pe=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"default",{enumerable:!0,get:function(){return t.createSvgIcon}});var t=ze}(Me)),Me}var Oe=n;Object.defineProperty(Ce,"__esModule",{value:!0});var Ie=Ce.default=void 0,$e=Oe(_e()),Fe=t;Ie=Ce.default=(0,$e.default)((0,Fe.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete");var Ee={},Ae=n;Object.defineProperty(Ee,"__esModule",{value:!0});var He=Ee.default=void 0,De=Ae(_e()),Te=t;He=Ee.default=(0,De.default)((0,Te.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add");var We={},Le=n;Object.defineProperty(We,"__esModule",{value:!0});var Ve=We.default=void 0,Be=Le(_e()),Re=t;Ve=We.default=(0,Be.default)((0,Re.jsx)("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm2 16H8v-2h8zm0-4H8v-2h8zm-3-5V3.5L18.5 9z"}),"Description");const Ne="https://sheets.googleapis.com/v4",Ge="https://www.googleapis.com/drive/v3",qe=async(e,t)=>{var r;try{const a=await fetch(`${Ne}/spreadsheets`,{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({properties:{title:t},sheets:[{properties:{title:"Sheet1",gridProperties:{rowCount:1e3,columnCount:26}}}]})});if(!a.ok){const e=await a.text();let t;try{t=JSON.parse(e)}catch(s){t={error:{message:e}}}throw new Error((null==(r=t.error)?void 0:r.message)||`Failed to create sheet: ${a.status} ${a.statusText}`)}return await a.json()}catch(a){throw a}},Je=async(e,t)=>{var r;try{const a=await fetch(`${Ge}/files/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${e}`}});if(!a.ok){const e=await a.text();let t;try{t=JSON.parse(e)}catch(s){t={error:{message:e}}}throw new Error((null==(r=t.error)?void 0:r.message)||`Failed to delete sheet: ${a.status} ${a.statusText}`)}return!0}catch(a){throw a}};function Ue(){const e=xe(),{settings:r}=Se(),[a,n]=ce.useState([]),[z,P]=ce.useState(!0),[_,O]=ce.useState(null),[I,$]=ce.useState(!1),[F,E]=ce.useState(null),[A,H]=ce.useState({open:!1,message:"",severity:"success"});ce.useEffect((()=>{D()}),[]);const D=async()=>{try{P(!0),O(null);const t=localStorage.getItem("access_token");if(!t)return void e("/login");const r=await(async e=>{var t;try{const s=await fetch(`${Ge}/files?q=mimeType='application/vnd.google-apps.spreadsheet'&fields=files(id,name,webViewLink)`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!s.ok){const e=await s.text();let a;try{a=JSON.parse(e)}catch(r){a={error:{message:e}}}throw new Error((null==(t=a.error)?void 0:t.message)||`Failed to fetch sheets: ${s.status} ${s.statusText}`)}return(await s.json()).files}catch(s){throw s}})(t);n(r)}catch(t){O(t instanceof Error?t.message:"Failed to fetch sheets")}finally{P(!1)}},T=()=>{e("/sheets")},W=()=>{$(!1),E(null)},L=()=>{H({...A,open:!1})},V=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A";return z?t.jsx(o,{maxWidth:"lg",sx:{py:4},children:t.jsx(i,{elevation:0,sx:{p:4,textAlign:"center",background:e=>s(e.palette.background.paper,.8),backdropFilter:"blur(10px)"},children:t.jsx(l,{variant:"h6",color:"text.secondary",children:"Loading your sheets..."})})}):_?t.jsx(o,{maxWidth:"lg",sx:{py:4},children:t.jsxs(i,{elevation:0,sx:{p:4,textAlign:"center",background:e=>s(e.palette.background.paper,.8),backdropFilter:"blur(10px)"},children:[t.jsx(l,{color:"error",gutterBottom:!0,children:_}),t.jsx(c,{variant:"contained",onClick:D,sx:{mt:2},children:"Try Again"})]})}):t.jsxs(o,{maxWidth:"lg",sx:{py:4},children:[t.jsxs(i,{elevation:0,sx:{p:4,mb:4,background:e=>s(e.palette.background.paper,.8),backdropFilter:"blur(10px)",borderRadius:r.compactMode?4:8},children:[t.jsxs(d,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[t.jsx(l,{variant:"h4",component:"h1",sx:{fontWeight:600,background:e=>`linear-gradient(45deg, ${e.palette.primary.main}, ${e.palette.secondary.main})`,WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"My Google Sheets"}),t.jsx(c,{variant:"contained",startIcon:t.jsx(He,{}),onClick:T,size:"large",sx:{borderRadius:r.compactMode?4:8,padding:r.compactMode?"6px 12px":"8px 16px",boxShadow:e=>`0 4px 14px 0 ${s(e.palette.primary.main,.3)}`,"&:hover":{transform:r.animations?"translateY(-2px)":"none",boxShadow:e=>`0 6px 20px 0 ${s(e.palette.primary.main,.4)}`},transition:r.animations?"all 0.3s ease":"none"},children:"Create New Sheet"})]}),0===a.length?t.jsxs(d,{sx:{textAlign:"center",py:8},children:[t.jsx(l,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"No sheets found"}),t.jsx(c,{variant:"contained",startIcon:t.jsx(He,{}),onClick:T,sx:{mt:2},children:"Create Your First Sheet"})]}):t.jsx(h,{container:!0,spacing:3,children:a.map((a=>t.jsx(h,{item:!0,xs:12,sm:6,md:4,component:"div",children:t.jsx(x,{in:r.animations,timeout:500,children:t.jsxs(u,{sx:{height:"100%",display:"flex",flexDirection:"column",background:e=>s(e.palette.background.paper,.9),backdropFilter:"blur(10px)",borderRadius:r.compactMode?4:8,transition:r.animations?"transform 0.2s, box-shadow 0.2s":"none",cursor:"pointer","&:hover":{transform:r.animations?"translateY(-4px)":"none",boxShadow:e=>e.shadows[4]}},onClick:()=>e(`/sheets/${a.id}`),children:[t.jsxs(p,{sx:{flexGrow:1,transition:r.animations?"all 0.3s ease":"none"},children:[t.jsxs(d,{sx:{display:"flex",alignItems:"center",mb:2},children:[t.jsx(m,{sx:{bgcolor:"primary.main",mr:2,width:r.compactMode?32:40,height:r.compactMode?32:40},children:t.jsx(Ve,{})}),t.jsx(l,{variant:r.compactMode?"h6":"h5",component:"div",noWrap:!0,sx:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:a.name})]}),t.jsx(j,{sx:{my:1}}),t.jsxs(d,{sx:{mt:2},children:[t.jsx(f,{size:r.compactMode?"small":"medium",label:`Created: ${V(a.createdTime)}`,sx:{mr:1,mb:1}}),t.jsx(f,{size:r.compactMode?"small":"medium",label:`Modified: ${V(a.modifiedTime)}`})]})]}),t.jsxs(g,{sx:{justifyContent:"space-between",p:2},children:[t.jsx(c,{size:r.compactMode?"small":"medium",onClick:e=>{e.stopPropagation(),window.open(a.webViewLink,"_blank")},children:"Open"}),t.jsx(v,{title:"Delete sheet",children:t.jsx(b,{size:r.compactMode?"small":"medium",color:"error",onClick:e=>{e.stopPropagation(),E(a),$(!0)},children:t.jsx(Ie,{})})})]})]})})},a.id)))})]}),t.jsxs(y,{open:I,onClose:W,PaperProps:{sx:{borderRadius:r.compactMode?4:8,background:e=>s(e.palette.background.paper,.9),backdropFilter:"blur(10px)"}},children:[t.jsx(k,{children:"Delete Sheet"}),t.jsx(w,{children:t.jsxs(l,{children:['Are you sure you want to delete "',null==F?void 0:F.name,'"? This action cannot be undone.']})}),t.jsxs(S,{children:[t.jsx(c,{onClick:W,children:"Cancel"}),t.jsx(c,{onClick:async()=>{if(F)try{const t=localStorage.getItem("access_token");if(!t)return void e("/login");await Je(t,F.id),n(a.filter((e=>e.id!==F.id))),H({open:!0,message:"Sheet deleted successfully",severity:"success"})}catch(t){H({open:!0,message:t instanceof Error?t.message:"Failed to delete sheet",severity:"error"})}finally{$(!1),E(null)}},color:"error",sx:{"&:hover":{transform:r.animations?"scale(1.05)":"none"},transition:r.animations?"all 0.2s ease":"none"},children:"Delete"})]})]}),t.jsx(C,{open:A.open,autoHideDuration:6e3,onClose:L,anchorOrigin:{vertical:"bottom",horizontal:"center"},children:t.jsx(M,{onClose:L,severity:A.severity,sx:{width:"100%",borderRadius:r.compactMode?4:8,background:e=>s(e.palette.background.paper,.9),backdropFilter:"blur(10px)"},children:A.message})})]})}var Ye={},Ke=n;Object.defineProperty(Ye,"__esModule",{value:!0});var Qe=Ye.default=void 0,Xe=Ke(_e()),Ze=t;Qe=Ye.default=(0,Xe.default)((0,Ze.jsx)("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"}),"ArrowBack");var et={},tt=n;Object.defineProperty(et,"__esModule",{value:!0});var rt=et.default=void 0,st=tt(_e()),at=t;rt=et.default=(0,st.default)((0,at.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit");var nt={},ot=n;Object.defineProperty(nt,"__esModule",{value:!0});var it=nt.default=void 0,lt=ot(_e()),ct=t;it=nt.default=(0,lt.default)((0,ct.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"}),"Save");var dt={},ht=n;Object.defineProperty(dt,"__esModule",{value:!0});var xt=dt.default=void 0,ut=ht(_e()),pt=t;xt=dt.default=(0,ut.default)((0,pt.jsx)("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"}),"MoreVert");var mt={},jt=n;Object.defineProperty(mt,"__esModule",{value:!0});var ft=mt.default=void 0,gt=jt(_e()),vt=t;ft=mt.default=(0,gt.default)((0,vt.jsx)("path",{d:"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92"}),"Share");var bt={},yt=n;Object.defineProperty(bt,"__esModule",{value:!0});var kt=bt.default=void 0,wt=yt(_e()),St=t;kt=bt.default=(0,wt.default)((0,St.jsx)("path",{d:"M5 20h14v-2H5zM19 9h-4V3H9v6H5l7 7z"}),"Download");var Ct={},Mt=n;Object.defineProperty(Ct,"__esModule",{value:!0});var zt=Ct.default=void 0,Pt=Mt(_e()),_t=t;zt=Ct.default=(0,Pt.default)((0,_t.jsx)("path",{d:"M19 8H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3m-3 11H8v-5h8zm3-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1m-1-9H6v4h12z"}),"Print");var Ot={},It=n;Object.defineProperty(Ot,"__esModule",{value:!0});var $t=Ot.default=void 0,Ft=It(_e()),Et=t;$t=Ot.default=(0,Ft.default)((0,Et.jsx)("path",{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6"}),"Settings");var At={},Ht=n;Object.defineProperty(At,"__esModule",{value:!0});var Dt=At.default=void 0,Tt=Ht(_e()),Wt=t;Dt=At.default=(0,Tt.default)((0,Wt.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-6h2zm0-8h-2V7h2z"}),"Info");var Lt={},Vt=n;Object.defineProperty(Lt,"__esModule",{value:!0});var Bt=Lt.default=void 0,Rt=Vt(_e()),Nt=t;Bt=Lt.default=(0,Rt.default)((0,Nt.jsx)("path",{d:"m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"}),"ExpandLess");var Gt={},qt=n;Object.defineProperty(Gt,"__esModule",{value:!0});var Jt=Gt.default=void 0,Ut=qt(_e()),Yt=t;Jt=Gt.default=(0,Ut.default)((0,Yt.jsx)("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore");var Kt={},Qt=n;Object.defineProperty(Kt,"__esModule",{value:!0});var Xt=Kt.default=void 0,Zt=Qt(_e()),er=t;Xt=Kt.default=(0,Zt.default)((0,er.jsx)("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"}),"ContentCopy");var tr={},rr=n;Object.defineProperty(tr,"__esModule",{value:!0});var sr=tr.default=void 0,ar=rr(_e()),nr=t;sr=tr.default=(0,ar.default)((0,nr.jsx)("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"}),"History");var or={},ir=n;Object.defineProperty(or,"__esModule",{value:!0});var lr=or.default=void 0,cr=ir(_e()),dr=t;lr=or.default=(0,cr.default)((0,dr.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 17h-2v-2h2zm2.07-7.75-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25"}),"Help");var hr={},xr=n;Object.defineProperty(hr,"__esModule",{value:!0});var ur=hr.default=void 0,pr=xr(_e()),mr=t;ur=hr.default=(0,pr.default)((0,mr.jsx)("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m-7 12h-2v-2h2zm0-4h-2V6h2z"}),"Feedback");var jr={},fr=n;Object.defineProperty(jr,"__esModule",{value:!0});var gr=jr.default=void 0,vr=fr(_e()),br=t;gr=jr.default=(0,vr.default)((0,br.jsx)("path",{d:"M20 2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m-8.5 7.5c0 .83-.67 1.5-1.5 1.5H9v2H7.5V7H10c.83 0 1.5.67 1.5 1.5zm5 2c0 .83-.67 1.5-1.5 1.5h-2.5V7H15c.83 0 1.5.67 1.5 1.5zm4-3H19v1h1.5V11H19v2h-1.5V7h3zM9 9.5h1v-1H9zM4 6H2v14c0 1.1.9 2 2 2h14v-2H4zm10 5.5h1v-3h-1z"}),"PictureAsPdf");var yr={},kr=n;Object.defineProperty(yr,"__esModule",{value:!0});var wr=yr.default=void 0,Sr=kr(_e()),Cr=t;function Mr(e){const{children:r,value:s,index:a,...n}=e;return t.jsx("div",{role:"tabpanel",hidden:s!==a,id:`sheet-tabpanel-${a}`,"aria-labelledby":`sheet-tab-${a}`,...n,children:s===a&&t.jsx(d,{sx:{p:3},children:r})})}function zr(){var e,r,a,n;const o=xe(),{sheetId:h}=ue(),[x,u]=ce.useState(""),[p,g]=ce.useState(!1),[C,N]=ce.useState(null),[G,q]=ce.useState(null),[J,U]=ce.useState(!1),[Y,K]=ce.useState(0),[Q,X]=ce.useState(null),[Z,ee]=ce.useState(!1),[te,re]=ce.useState(!1),[se,ae]=ce.useState(!1),[ne,oe]=ce.useState(""),[ie,le]=ce.useState("viewer"),[de,he]=ce.useState(!1),[pe,me]=ce.useState({isPublic:!1,allowComments:!1,allowEdit:!1});ce.useEffect((()=>{h&&je()}),[h]);const je=async()=>{try{g(!0),N(null);const e=localStorage.getItem("access_token");if(!e)return void o("/login");const t=await(async(e,t)=>{try{const r=await fetch(`${Ne}/spreadsheets/${t}`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!r.ok){await r.json();throw new Error(`Failed to fetch sheet details: ${r.status} ${r.statusText}`)}const s=await r.json();return{id:s.spreadsheetId,name:s.properties.title,webViewLink:s.spreadsheetUrl,createdTime:s.createdTime,modifiedTime:s.modifiedTime}}catch(r){throw r}})(e,h);q(t),u(t.name)}catch(e){N(e instanceof Error?e.message:"Failed to fetch sheet details")}finally{g(!1)}},fe=async()=>{if(x.trim())try{g(!0),N(null);const e=localStorage.getItem("access_token");if(!e)return void o("/login");h?(await(async(e,t,r)=>{try{const s=await fetch(`${Ne}/spreadsheets/${t}`,{method:"PATCH",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({properties:{title:r}})});if(!s.ok){await s.json();throw new Error(`Failed to update sheet title: ${s.status} ${s.statusText}`)}}catch(s){throw s}})(e,h,x),q((e=>e?{...e,name:x}:null)),U(!1)):(await qe(e,x),o("/home"))}catch(e){N(e instanceof Error?e.message:"Failed to create sheet")}finally{g(!1)}else N("Please enter a title for your sheet")},ge=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",ve=()=>{X(null)},be=e=>{ve();const t=document.querySelector("iframe");if(t&&t.contentWindow){const r=t.src.replace("embedded=true",`export=download&format=${e}`),s=document.createElement("a");s.href=r,s.download=`${(null==G?void 0:G.name)||"sheet"}.${e}`,document.body.appendChild(s),s.click(),document.body.removeChild(s)}},ye=()=>{ve(),o("/settings")},ke=async()=>{if(ne)try{const e=localStorage.getItem("access_token");if(!e)return void o("/login");const t=await fetch(`http://localhost:3000/sheets/${h}/share`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({email:ne,role:ie})});if(!t.ok)throw new Error("Failed to share sheet");const r=await t.json();q(r),oe("")}catch(e){}},we=async(e,t)=>{try{const r=localStorage.getItem("access_token");if(!r)return void o("/login");const s=await fetch(`http://localhost:3000/sheets/${h}/permissions`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({[e]:t})});if(!s.ok)throw new Error("Failed to update permissions");const a=await s.json();q(a),me((r=>({...r,[e]:t})))}catch(r){}};return t.jsx(d,{sx:{display:"flex",flexDirection:"column",height:"100vh"},children:h?t.jsxs(t.Fragment,{children:[t.jsx(z,{position:"static",elevation:0,sx:{background:e=>s(e.palette.background.paper,.8),backdropFilter:"blur(10px)",borderBottom:e=>`1px solid ${s(e.palette.divider,.1)}`},children:t.jsxs(P,{children:[t.jsx(c,{startIcon:t.jsx(Qe,{}),onClick:()=>o("/home"),sx:{mr:2},children:"Back"}),t.jsxs(d,{sx:{flexGrow:1,display:"flex",alignItems:"center",gap:2},children:[t.jsx(m,{sx:{bgcolor:"primary.main",width:32,height:32},children:t.jsx(Ve,{})}),J?t.jsx(_,{value:x,onChange:e=>u(e.target.value),variant:"standard",sx:{"& .MuiInputBase-root":{fontSize:"1.1rem",fontWeight:500}}}):t.jsx(l,{variant:"h6",noWrap:!0,children:null==G?void 0:G.name})]}),t.jsxs(d,{sx:{display:"flex",gap:1},children:[t.jsx(v,{title:"Save changes",children:t.jsx(b,{onClick:fe,disabled:p||!J,sx:{"&:hover":{backgroundColor:"primary.light",color:"white"}},children:t.jsx(it,{})})}),t.jsx(v,{title:"Edit title",children:t.jsx(b,{onClick:()=>U(!J),sx:{"&:hover":{backgroundColor:"primary.light",color:"white"}},children:t.jsx(rt,{})})}),t.jsx(b,{onClick:e=>{X(e.currentTarget)},sx:{"&:hover":{backgroundColor:"primary.light",color:"white"}},children:t.jsx(xt,{})})]})]})}),t.jsxs(O,{anchorEl:Q,open:Boolean(Q),onClose:ve,PaperProps:{sx:{background:e=>s(e.palette.background.paper,.9),backdropFilter:"blur(10px)",mt:1,minWidth:240}},children:[t.jsxs(I,{onClick:()=>{ve(),K(2)},children:[t.jsx($,{children:t.jsx(ft,{fontSize:"small"})}),t.jsx(F,{children:"Share"})]}),t.jsxs(E,{onClick:()=>{ee(!Z)},children:[t.jsx($,{children:t.jsx(kt,{fontSize:"small"})}),t.jsx(F,{primary:"Export"}),Z?t.jsx(Bt,{}):t.jsx(Jt,{})]}),t.jsx(A,{in:Z,timeout:"auto",unmountOnExit:!0,children:t.jsxs(d,{sx:{pl:4},children:[t.jsxs(I,{onClick:()=>be("pdf"),children:[t.jsx($,{children:t.jsx(gr,{fontSize:"small"})}),t.jsx(F,{children:"Download as PDF"})]}),t.jsxs(I,{onClick:()=>be("xlsx"),children:[t.jsx($,{children:t.jsx(wr,{fontSize:"small"})}),t.jsx(F,{children:"Download as Excel"})]}),t.jsxs(I,{onClick:()=>be("csv"),children:[t.jsx($,{children:t.jsx(wr,{fontSize:"small"})}),t.jsx(F,{children:"Download as CSV"})]})]})}),t.jsxs(I,{onClick:()=>{ve();const e=document.querySelector("iframe");if(e){const t=e.contentWindow;t&&(t.focus(),t.print())}},children:[t.jsx($,{children:t.jsx(zt,{fontSize:"small"})}),t.jsx(F,{children:"Print"})]}),t.jsx(j,{}),t.jsxs(I,{onClick:async()=>{ve();try{g(!0);const e=localStorage.getItem("access_token");if(!e)return void o("/login");const t=`${null==G?void 0:G.name} (Copy)`;await qe(e,t),o("/home")}catch(e){N(e instanceof Error?e.message:"Failed to create copy")}finally{g(!1)}},children:[t.jsx($,{children:t.jsx(Xt,{fontSize:"small"})}),t.jsx(F,{children:"Make a Copy"})]}),t.jsxs(I,{onClick:()=>{ve(),window.open(`${null==G?void 0:G.webViewLink}&action=viewrevisionhistory`,"_blank")},children:[t.jsx($,{children:t.jsx(sr,{fontSize:"small"})}),t.jsx(F,{children:"Version History"})]}),t.jsx(j,{}),t.jsxs(E,{onClick:()=>{re(!te)},children:[t.jsx($,{children:t.jsx($t,{fontSize:"small"})}),t.jsx(F,{primary:"Settings"}),te?t.jsx(Bt,{}):t.jsx(Jt,{})]}),t.jsx(A,{in:te,timeout:"auto",unmountOnExit:!0,children:t.jsxs(d,{sx:{pl:4},children:[t.jsx(I,{onClick:ye,children:t.jsx(F,{primary:"General Settings"})}),t.jsx(I,{onClick:ye,children:t.jsx(F,{primary:"Notifications"})}),t.jsx(I,{onClick:ye,children:t.jsx(F,{primary:"Appearance"})})]})}),t.jsx(j,{}),t.jsxs(I,{onClick:()=>{ve(),o("/help")},children:[t.jsx($,{children:t.jsx(lr,{fontSize:"small"})}),t.jsx(F,{children:"Help & Support"})]}),t.jsxs(I,{onClick:ve,children:[t.jsx($,{children:t.jsx(ur,{fontSize:"small"})}),t.jsx(F,{children:"Send Feedback"})]}),t.jsxs(I,{onClick:()=>{ve(),o("/about")},children:[t.jsx($,{children:t.jsx(Dt,{fontSize:"small"})}),t.jsx(F,{children:"About"})]}),t.jsx(j,{}),t.jsxs(I,{onClick:async()=>{ve(),ae(!0)},sx:{color:"error.main"},children:[t.jsx($,{children:t.jsx(Ie,{fontSize:"small"})}),t.jsx(F,{children:"Delete Sheet"})]})]}),t.jsxs(y,{open:se,onClose:()=>ae(!1),PaperProps:{sx:{background:e=>s(e.palette.background.paper,.9),backdropFilter:"blur(10px)"}},children:[t.jsx(k,{children:"Delete Sheet"}),t.jsx(w,{children:t.jsx(H,{children:"Are you sure you want to delete this sheet? This action cannot be undone."})}),t.jsxs(S,{children:[t.jsx(c,{onClick:()=>ae(!1),children:"Cancel"}),t.jsx(c,{onClick:async()=>{try{g(!0);const e=localStorage.getItem("access_token");if(!e)return void o("/login");await Je(e,h),o("/home")}catch(e){N(e instanceof Error?e.message:"Failed to delete sheet")}finally{g(!1),ae(!1)}},color:"error",variant:"contained",disabled:p,children:p?t.jsx(D,{size:24}):"Delete"})]})]}),t.jsxs(d,{sx:{flexGrow:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[t.jsx(d,{sx:{borderBottom:1,borderColor:"divider"},children:t.jsxs(T,{value:Y,onChange:(e,t)=>{K(t)},sx:{background:e=>s(e.palette.background.paper,.8),backdropFilter:"blur(10px)"},children:[t.jsx(W,{label:"Overview"}),t.jsx(W,{label:"Editor"}),t.jsx(W,{label:"Sharing"})]})}),t.jsxs(d,{sx:{flexGrow:1,overflow:"auto",position:"relative"},children:[t.jsx(Mr,{value:Y,index:0,children:t.jsxs(d,{sx:{p:3},children:[t.jsx(l,{variant:"h6",sx:{mb:3},children:"Sheet Information"}),t.jsxs(d,{sx:{display:"flex",flexDirection:"column",gap:3},children:[t.jsxs(i,{elevation:0,sx:{p:3,background:e=>s(e.palette.background.paper,.8),backdropFilter:"blur(10px)",border:e=>`1px solid ${s(e.palette.divider,.1)}`},children:[t.jsx(l,{variant:"subtitle1",sx:{mb:2},children:"Basic Information"}),t.jsxs(d,{sx:{display:"flex",flexDirection:"column",gap:2},children:[t.jsxs(d,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(l,{variant:"body2",color:"text.secondary",children:"Title"}),t.jsx(l,{variant:"body1",children:null==G?void 0:G.name})]}),t.jsx(j,{}),t.jsxs(d,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(l,{variant:"body2",color:"text.secondary",children:"Created"}),t.jsx(l,{variant:"body1",children:ge(null==G?void 0:G.createdTime)})]}),t.jsx(j,{}),t.jsxs(d,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(l,{variant:"body2",color:"text.secondary",children:"Last Modified"}),t.jsx(l,{variant:"body1",children:ge(null==G?void 0:G.modifiedTime)})]})]})]}),t.jsxs(i,{elevation:0,sx:{p:3,background:e=>s(e.palette.background.paper,.8),backdropFilter:"blur(10px)",border:e=>`1px solid ${s(e.palette.divider,.1)}`},children:[t.jsx(l,{variant:"subtitle1",sx:{mb:2},children:"Document Statistics"}),t.jsxs(d,{sx:{display:"flex",flexDirection:"column",gap:2},children:[t.jsxs(d,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(l,{variant:"body2",color:"text.secondary",children:"Number of Sheets"}),t.jsx(f,{label:(null==(e=null==G?void 0:G.sheets)?void 0:e.length)||0,size:"small",color:"primary"})]}),t.jsx(j,{}),t.jsxs(d,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(l,{variant:"body2",color:"text.secondary",children:"Total Cells"}),t.jsx(l,{variant:"body1",children:(null==(r=null==G?void 0:G.sheets)?void 0:r.reduce(((e,t)=>{var r,s;return e+((null==(r=t.properties.gridProperties)?void 0:r.rowCount)||0)*((null==(s=t.properties.gridProperties)?void 0:s.columnCount)||0)}),0))||0})]})]})]}),t.jsxs(i,{elevation:0,sx:{p:3,background:e=>s(e.palette.background.paper,.8),backdropFilter:"blur(10px)",border:e=>`1px solid ${s(e.palette.divider,.1)}`},children:[t.jsx(l,{variant:"subtitle1",sx:{mb:2},children:"Quick Actions"}),t.jsxs(d,{sx:{display:"flex",gap:2},children:[t.jsx(c,{variant:"outlined",startIcon:t.jsx(kt,{}),onClick:()=>{const e=document.querySelector("iframe");if(e&&e.contentWindow){const t=e.src.replace("embedded=true","export=download&format=xlsx"),r=document.createElement("a");r.href=t,r.download=`${(null==G?void 0:G.name)||"sheet"}.xlsx`,document.body.appendChild(r),r.click(),document.body.removeChild(r)}},children:"Download"}),t.jsx(c,{variant:"outlined",startIcon:t.jsx(zt,{}),onClick:()=>{const e=document.querySelector("iframe");if(e){const t=e.contentWindow;t&&(t.focus(),t.print())}},children:"Print"})]})]})]})]})}),t.jsx(Mr,{value:Y,index:1,children:t.jsxs(d,{sx:{width:"100%",height:"calc(100vh - 120px)",borderRadius:0,overflow:"hidden",position:"relative",display:"flex",flexDirection:"column"},children:[t.jsx(d,{sx:{position:"absolute",top:0,left:0,right:0,height:"40px",background:e=>s(e.palette.background.paper,.8),backdropFilter:"blur(10px)",display:"flex",alignItems:"center",justifyContent:"space-between",px:2,borderBottom:e=>`1px solid ${s(e.palette.divider,.1)}`,zIndex:1},children:t.jsx(d,{sx:{display:"flex",alignItems:"center",gap:1},children:t.jsx(f,{size:"small",label:"Google Sheets",icon:t.jsx(Ve,{})})})}),t.jsx(d,{sx:{flex:1,marginTop:"40px",height:"calc(100% - 40px)"},children:t.jsx("iframe",{src:`${null==G?void 0:G.webViewLink}?embedded=true`,style:{width:"100%",height:"100%",border:"none"},title:"Google Sheet Editor",allowFullScreen:!0})})]})}),t.jsxs(Mr,{value:Y,index:2,children:[t.jsxs(d,{sx:{p:3},children:[t.jsx(l,{variant:"h6",sx:{mb:3},children:"Sharing Settings"}),t.jsxs(d,{sx:{display:"flex",flexDirection:"column",gap:3},children:[t.jsxs(i,{elevation:0,sx:{p:3,background:e=>s(e.palette.background.paper,.8),backdropFilter:"blur(10px)",border:e=>`1px solid ${s(e.palette.divider,.1)}`},children:[t.jsx(l,{variant:"subtitle1",sx:{mb:2},children:"Share with People"}),t.jsxs(d,{sx:{display:"flex",flexDirection:"column",gap:2},children:[t.jsx(_,{fullWidth:!0,placeholder:"Add people or groups",variant:"outlined",size:"small",value:ne,onChange:e=>oe(e.target.value),InputProps:{endAdornment:t.jsx(c,{variant:"contained",size:"small",onClick:ke,disabled:!ne,children:"Share"})}}),t.jsxs(d,{sx:{display:"flex",gap:1},children:[t.jsx(c,{variant:"outlined",size:"small",onClick:()=>{navigator.clipboard.writeText((null==G?void 0:G.webViewLink)||"")},children:"Copy Link"}),t.jsx(c,{variant:"outlined",size:"small",onClick:()=>he(!0),children:"Advanced"})]})]})]}),t.jsxs(i,{elevation:0,sx:{p:3,background:e=>s(e.palette.background.paper,.8),backdropFilter:"blur(10px)",border:e=>`1px solid ${s(e.palette.divider,.1)}`},children:[t.jsx(l,{variant:"subtitle1",sx:{mb:2},children:"Advanced Settings"}),t.jsxs(d,{sx:{display:"flex",flexDirection:"column",gap:2},children:[t.jsxs(d,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(l,{variant:"body2",children:"Allow anyone with the link to view"}),t.jsx(L,{checked:pe.isPublic,onChange:e=>we("isPublic",e.target.checked),size:"small"})]}),t.jsx(j,{}),t.jsxs(d,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(l,{variant:"body2",children:"Allow anyone with the link to comment"}),t.jsx(L,{checked:pe.allowComments,onChange:e=>we("allowComments",e.target.checked),size:"small"})]}),t.jsx(j,{}),t.jsxs(d,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(l,{variant:"body2",children:"Allow anyone with the link to edit"}),t.jsx(L,{checked:pe.allowEdit,onChange:e=>we("allowEdit",e.target.checked),size:"small"})]})]})]}),t.jsxs(i,{elevation:0,sx:{p:3,background:e=>s(e.palette.background.paper,.8),backdropFilter:"blur(10px)",border:e=>`1px solid ${s(e.palette.divider,.1)}`},children:[t.jsx(l,{variant:"subtitle1",sx:{mb:2},children:"People with Access"}),t.jsx(d,{sx:{display:"flex",flexDirection:"column",gap:2},children:null==(n=null==(a=null==G?void 0:G.sharing)?void 0:a.sharedWith)?void 0:n.map(((e,r)=>{var s;return t.jsxs(d,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs(d,{sx:{display:"flex",alignItems:"center",gap:1},children:[t.jsx(m,{src:e.photoUrl,sx:{width:32,height:32},children:null==(s=e.displayName)?void 0:s[0]}),t.jsxs(d,{children:[t.jsx(l,{variant:"body2",children:e.displayName}),t.jsx(l,{variant:"caption",color:"text.secondary",children:e.email})]})]}),t.jsxs(d,{sx:{display:"flex",alignItems:"center",gap:1},children:[t.jsx(f,{label:e.role,size:"small",color:"Owner"===e.role?"primary":"Editor"===e.role?"success":"Commenter"===e.role?"info":"default"}),t.jsx(b,{size:"small",onClick:async()=>{try{const t=localStorage.getItem("access_token");if(!t)return void o("/login");const r=await fetch(`http://localhost:3000/sheets/${h}/remove-access`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({email:e.email})});if(!r.ok)throw new Error("Failed to remove access");const s=await r.json();q(s)}catch(t){}},children:t.jsx(Ie,{fontSize:"small"})})]})]},r)}))})]})]})]}),t.jsxs(y,{open:de,onClose:()=>he(!1),PaperProps:{sx:{background:e=>s(e.palette.background.paper,.9),backdropFilter:"blur(10px)"}},children:[t.jsx(k,{children:"Advanced Sharing Settings"}),t.jsx(w,{children:t.jsxs(d,{sx:{display:"flex",flexDirection:"column",gap:2,pt:2},children:[t.jsx(_,{label:"Email",value:ne,onChange:e=>oe(e.target.value),fullWidth:!0,size:"small"}),t.jsxs(V,{fullWidth:!0,size:"small",children:[t.jsx(B,{children:"Role"}),t.jsxs(R,{value:ie,onChange:e=>le(e.target.value),label:"Role",children:[t.jsx(I,{value:"viewer",children:"Viewer"}),t.jsx(I,{value:"commenter",children:"Commenter"}),t.jsx(I,{value:"editor",children:"Editor"})]})]})]})}),t.jsxs(S,{children:[t.jsx(c,{onClick:()=>he(!1),children:"Cancel"}),t.jsx(c,{onClick:()=>{ke(),he(!1)},variant:"contained",disabled:!ne,children:"Share"})]})]})]})]})]}),t.jsx(d,{sx:{height:"24px",background:e=>s(e.palette.background.paper,.8),backdropFilter:"blur(10px)",borderTop:e=>`1px solid ${s(e.palette.divider,.1)}`,display:"flex",alignItems:"center",px:2,fontSize:"0.75rem",color:"text.secondary"},children:t.jsxs(d,{sx:{display:"flex",gap:2},children:[t.jsx(l,{variant:"caption",children:null==G?void 0:G.name}),t.jsxs(l,{variant:"caption",children:["Last modified: ",ge(null==G?void 0:G.modifiedTime)]})]})})]}):t.jsx(d,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100vh",p:4,background:e=>s(e.palette.background.paper,.8),backdropFilter:"blur(10px)"},children:t.jsxs(i,{elevation:0,sx:{p:4,maxWidth:500,width:"100%",display:"flex",flexDirection:"column",gap:3,background:e=>s(e.palette.background.paper,.9),backdropFilter:"blur(10px)",border:e=>`1px solid ${s(e.palette.divider,.1)}`},children:[t.jsxs(d,{sx:{textAlign:"center",mb:2},children:[t.jsx(m,{sx:{width:64,height:64,bgcolor:"primary.main",mb:2,mx:"auto"},children:t.jsx(Ve,{sx:{fontSize:32}})}),t.jsx(l,{variant:"h4",component:"h1",sx:{fontWeight:600,background:e=>`linear-gradient(45deg, ${e.palette.primary.main}, ${e.palette.secondary.main})`,WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"Create New Sheet"}),t.jsx(l,{variant:"body1",color:"text.secondary",sx:{mt:1},children:"Enter a title for your new Google Sheet"})]}),C&&t.jsx(M,{severity:"error",sx:{width:"100%"},children:C}),t.jsx(_,{label:"Sheet Title",variant:"outlined",value:x,onChange:e=>u(e.target.value),fullWidth:!0,disabled:p,sx:{"& .MuiOutlinedInput-root":{"&:hover fieldset":{borderColor:"primary.main"}}}}),t.jsx(c,{variant:"contained",onClick:fe,disabled:p||!x.trim(),size:"large",sx:{py:1.5,borderRadius:2,boxShadow:e=>`0 4px 14px 0 ${s(e.palette.primary.main,.3)}`,"&:hover":{transform:"translateY(-2px)",boxShadow:e=>`0 6px 20px 0 ${s(e.palette.primary.main,.4)}`},transition:"all 0.3s ease"},children:p?t.jsx(D,{size:24,color:"inherit"}):"Create Sheet"}),t.jsx(c,{variant:"text",onClick:()=>o("/home"),sx:{mt:1},children:"Back to Home"})]})})})}wr=yr.default=(0,Sr.default)((0,Cr.jsx)("path",{d:"M10 10.02h5V21h-5zM17 21h3c1.1 0 2-.9 2-2v-9h-5zm3-18H5c-1.1 0-2 .9-2 2v3h19V5c0-1.1-.9-2-2-2M3 19c0 1.1.9 2 2 2h3V10H3z"}),"TableChart");var Pr={},_r=n;Object.defineProperty(Pr,"__esModule",{value:!0});var Or=Pr.default=void 0;!function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=Fr(void 0);if(t&&t.has(e))return t.get(e);var r={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var n=s?Object.getOwnPropertyDescriptor(e,a):null;n&&(n.get||n.set)?Object.defineProperty(r,a,n):r[a]=e[a]}r.default=e,t&&t.set(e,r)}(ce);var Ir=_r(_e()),$r=t;function Fr(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(Fr=function(e){return e?r:t})(e)}function Er(){const e=xe(),{settings:r}=Se(),[a,n]=ce.useState(!1),[h,x]=ce.useState(null),u=function({flow:e="implicit",scope:t="",onSuccess:r,onError:s,onNonOAuthError:a,overrideScope:n,state:o,...i}){const{clientId:l,scriptLoadedSuccessfully:c}=function(){const e=ce.useContext(ve);if(!e)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return e}(),d=ce.useRef(),h=ce.useRef(r);h.current=r;const x=ce.useRef(s);x.current=s;const u=ce.useRef(a);u.current=a,ce.useEffect((()=>{var r,s;if(!c)return;const a="implicit"===e?"initTokenClient":"initCodeClient",p=null===(s=null===(r=null===window||void 0===window?void 0:window.google)||void 0===r?void 0:r.accounts)||void 0===s?void 0:s.oauth2[a]({client_id:l,scope:n?t:`openid profile email ${t}`,callback:e=>{var t,r;if(e.error)return null===(t=x.current)||void 0===t?void 0:t.call(x,e);null===(r=h.current)||void 0===r||r.call(h,e)},error_callback:e=>{var t;null===(t=u.current)||void 0===t||t.call(u,e)},state:o,...i});d.current=p}),[l,c,e,t,o]);const p=ce.useCallback((e=>{var t;return null===(t=d.current)||void 0===t?void 0:t.requestAccessToken(e)}),[]),m=ce.useCallback((()=>{var e;return null===(e=d.current)||void 0===e?void 0:e.requestCode()}),[]);return"implicit"===e?p:m}({onSuccess:async t=>{try{const r=t.access_token;localStorage.setItem("access_token",r);const s=await fetch("https://www.googleapis.com/oauth2/v3/userinfo",{headers:{Authorization:`Bearer ${r}`}}).then((e=>e.json()));localStorage.setItem("user",JSON.stringify(s)),e("/home")}catch(r){x("Failed to fetch user information. Please try again.")}finally{n(!1)}},onError:()=>{x("Failed to sign in with Google. Please try again."),n(!1)},scope:"https://www.googleapis.com/auth/spreadsheets https://www.googleapis.com/auth/drive"});return t.jsx(o,{maxWidth:"sm",sx:{py:4},children:t.jsxs(i,{elevation:0,sx:{p:4,textAlign:"center",background:e=>s(e.palette.background.paper,.9),backdropFilter:"blur(10px)",borderRadius:r.compactMode?4:8},children:[t.jsxs(d,{sx:{mb:4},children:[t.jsx(l,{variant:"h4",component:"h1",sx:{fontWeight:600,background:e=>`linear-gradient(45deg, ${e.palette.primary.main}, ${e.palette.secondary.main})`,WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",mb:2},children:"Welcome to Google Sheets Manager"}),h&&t.jsx(l,{variant:"body1",color:"error",children:h}),t.jsx(l,{variant:"body1",color:"text.secondary",children:"Sign in with your Google account to manage your sheets"})]}),a?t.jsx(D,{}):t.jsx(c,{variant:"contained",startIcon:t.jsx(Or,{}),onClick:()=>{n(!0),u()},size:"large",sx:{width:"100%",maxWidth:300,py:1.5,borderRadius:2},children:"Sign in with Google"})]})})}function Ar(){const{settings:e,updateSettings:r}=Se(),[s,a]=ce.useState(!1),[n,c]=ce.useState({open:!1,message:"",severity:"success"}),d=(e,t)=>{r({[e]:t}),c({open:!0,message:"Settings updated successfully",severity:"success"})},h=(t,s)=>{r({notifications:{...e.notifications,[t]:s}}),c({open:!0,message:"Notification settings updated",severity:"success"})};return t.jsxs(o,{maxWidth:"md",sx:{py:4},children:[t.jsx(l,{variant:"h4",component:"h1",gutterBottom:!0,children:"Settings"}),t.jsx(i,{elevation:0,sx:{p:3,background:e=>e.palette.background.paper,borderRadius:e.compactMode?4:8},children:t.jsxs(N,{children:[t.jsxs(G,{children:[t.jsx($,{children:"light"===e.theme?t.jsx(q,{}):t.jsx(J,{})}),t.jsx(F,{primary:"Theme",secondary:"light"===e.theme?"Light mode":"Dark mode"}),t.jsx(L,{checked:"dark"===e.theme,onChange:()=>{r({theme:"light"===e.theme?"dark":"light"}),c({open:!0,message:`Switched to ${"light"===e.theme?"dark":"light"} mode`,severity:"success"})}})]}),t.jsx(j,{}),t.jsxs(G,{children:[t.jsx($,{children:t.jsx(U,{})}),t.jsx(F,{primary:"Compact Mode",secondary:"Use a more compact layout"}),t.jsx(L,{checked:e.compactMode,onChange:e=>d("compactMode",e.target.checked)})]}),t.jsx(j,{}),t.jsxs(G,{children:[t.jsx($,{children:t.jsx(Y,{})}),t.jsx(F,{primary:"Animations",secondary:"Enable smooth transitions and effects"}),t.jsx(L,{checked:e.animations,onChange:e=>d("animations",e.target.checked)})]}),t.jsx(j,{}),t.jsxs(G,{children:[t.jsx($,{children:t.jsx(K,{})}),t.jsx(F,{primary:"Auto-save",secondary:"Automatically save changes"}),t.jsx(L,{checked:e.autoSave,onChange:e=>d("autoSave",e.target.checked)})]}),t.jsx(j,{}),t.jsxs(G,{children:[t.jsx($,{children:t.jsx(Q,{})}),t.jsx(F,{primary:"Offline Mode",secondary:"Enable offline access"}),t.jsx(L,{checked:e.offlineMode,onChange:e=>d("offlineMode",e.target.checked)})]}),t.jsx(j,{}),t.jsxs(G,{children:[t.jsx($,{children:t.jsx(X,{})}),t.jsx(F,{primary:"Keyboard Shortcuts",secondary:"Enable keyboard shortcuts"}),t.jsx(L,{checked:e.keyboardShortcuts,onChange:e=>d("keyboardShortcuts",e.target.checked)})]}),t.jsx(j,{}),t.jsxs(G,{onClick:()=>a(!s),sx:{cursor:"pointer"},children:[t.jsx($,{children:t.jsx(Z,{})}),t.jsx(F,{primary:"Notifications",secondary:"Manage notification settings"}),s?t.jsx(ee,{}):t.jsx(te,{})]}),t.jsx(A,{in:s,timeout:"auto",unmountOnExit:!0,children:t.jsxs(N,{component:"div",disablePadding:!0,children:[t.jsxs(G,{sx:{pl:4},children:[t.jsx(F,{primary:"Enable Notifications"}),t.jsx(L,{checked:e.notifications.enabled,onChange:e=>h("enabled",e.target.checked)})]}),t.jsxs(G,{sx:{pl:4},children:[t.jsx(F,{primary:"Sound"}),t.jsx(L,{checked:e.notifications.sound,onChange:e=>h("sound",e.target.checked)})]}),t.jsxs(G,{sx:{pl:4},children:[t.jsx(F,{primary:"Desktop Notifications"}),t.jsx(L,{checked:e.notifications.desktop,onChange:e=>h("desktop",e.target.checked)})]})]})})]})}),t.jsx(C,{open:n.open,autoHideDuration:3e3,onClose:()=>c({...n,open:!1}),children:t.jsx(M,{onClose:()=>c({...n,open:!1}),severity:n.severity,sx:{width:"100%"},children:n.message})})]})}Or=Pr.default=(0,Ir.default)((0,$r.jsx)("path",{d:"M12.545,10.239v3.821h5.445c-0.712,2.315-2.647,3.972-5.445,3.972c-3.332,0-6.033-2.701-6.033-6.032s2.701-6.032,6.033-6.032c1.498,0,2.866,0.549,3.921,1.453l2.814-2.814C17.503,2.988,15.139,2,12.545,2C7.021,2,2.543,6.477,2.543,12s4.478,10,10.002,10c8.396,0,10.249-7.85,9.426-11.748L12.545,10.239z"}),"Google");var Hr={},Dr=n;Object.defineProperty(Hr,"__esModule",{value:!0});var Tr=Hr.default=void 0,Wr=Dr(_e()),Lr=t;function Vr(){const e=xe(),[r,a]=ce.useState(""),[n,h]=ce.useState(!1),x=[{question:"How do I create a new sheet?",answer:'Click the "Create Sheet" button on the home page or use the menu option in an existing sheet to make a copy.'},{question:"Can I share my sheets with others?",answer:'Yes, you can share your sheets by clicking the "Share" button in the menu. You can control whether others can view, comment, or edit your sheets.'},{question:"How do I export my sheet?",answer:'Use the "Export" option in the menu to download your sheet in various formats including PDF, Excel, and CSV.'},{question:"Is there a way to work offline?",answer:"Yes, you can enable offline mode in the Settings page. This will allow you to access and edit your sheets without an internet connection."}];return t.jsxs(o,{maxWidth:"md",sx:{py:4},children:[t.jsxs(d,{sx:{display:"flex",alignItems:"center",mb:4},children:[t.jsx(c,{startIcon:t.jsx(Qe,{}),onClick:()=>e(-1),sx:{mr:2},children:"Back"}),t.jsx(l,{variant:"h4",component:"h1",children:"Help & Support"})]}),t.jsx(i,{elevation:0,sx:{background:e=>s(e.palette.background.paper,.9),backdropFilter:"blur(10px)",borderRadius:2,overflow:"hidden",mb:4},children:t.jsxs(d,{sx:{p:3},children:[t.jsx(l,{variant:"h6",gutterBottom:!0,children:"Frequently Asked Questions"}),x.map(((e,r)=>{return t.jsxs(re,{expanded:n===`panel${r}`,onChange:(s=`panel${r}`,(e,t)=>{h(!!t&&s)}),sx:{background:"transparent",boxShadow:"none","&:before":{display:"none"}},children:[t.jsx(se,{expandIcon:t.jsx(Jt,{}),children:t.jsx(l,{children:e.question})}),t.jsx(ae,{children:t.jsx(l,{color:"text.secondary",children:e.answer})}),r<x.length-1&&t.jsx(j,{})]},r);var s}))]})}),t.jsx(i,{elevation:0,sx:{background:e=>s(e.palette.background.paper,.9),backdropFilter:"blur(10px)",borderRadius:2,overflow:"hidden",mb:4},children:t.jsxs(d,{sx:{p:3},children:[t.jsx(l,{variant:"h6",gutterBottom:!0,children:"Documentation & Resources"}),t.jsxs(N,{children:[t.jsxs(G,{button:!0,component:"a",href:"#",target:"_blank",children:[t.jsx($,{children:t.jsx(Ve,{})}),t.jsx(F,{primary:"User Guide",secondary:"Complete guide to using the application"})]}),t.jsx(j,{}),t.jsxs(G,{button:!0,component:"a",href:"#",target:"_blank",children:[t.jsx($,{children:t.jsx(lr,{})}),t.jsx(F,{primary:"Tutorials",secondary:"Step-by-step tutorials for common tasks"})]}),t.jsx(j,{}),t.jsxs(G,{button:!0,component:"a",href:"#",target:"_blank",children:[t.jsx($,{children:t.jsx(Tr,{})}),t.jsx(F,{primary:"Contact Support",secondary:"Get help from our support team"})]})]})]})}),t.jsx(i,{elevation:0,sx:{background:e=>s(e.palette.background.paper,.9),backdropFilter:"blur(10px)",borderRadius:2,overflow:"hidden"},children:t.jsxs(d,{sx:{p:3},children:[t.jsx(l,{variant:"h6",gutterBottom:!0,children:"Send Feedback"}),t.jsxs("form",{onSubmit:e=>{e.preventDefault(),a("")},children:[t.jsx(_,{fullWidth:!0,multiline:!0,rows:4,value:r,onChange:e=>a(e.target.value),placeholder:"Share your thoughts, suggestions, or report issues...",sx:{mb:2}}),t.jsx(c,{type:"submit",variant:"contained",startIcon:t.jsx(ur,{}),disabled:!r.trim(),children:"Send Feedback"})]})]})})]})}Tr=Hr.default=(0,Wr.default)((0,Lr.jsx)("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 4-8 5-8-5V6l8 5 8-5z"}),"Email");var Br={},Rr=n;Object.defineProperty(Br,"__esModule",{value:!0});var Nr=Br.default=void 0,Gr=Rr(_e()),qr=t;Nr=Br.default=(0,Gr.default)((0,qr.jsx)("path",{d:"M9.4 16.6 4.8 12l4.6-4.6L8 6l-6 6 6 6zm5.2 0 4.6-4.6-4.6-4.6L16 6l6 6-6 6z"}),"Code");var Jr={},Ur=n;Object.defineProperty(Jr,"__esModule",{value:!0});var Yr=Jr.default=void 0;!function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=Xr(void 0);if(t&&t.has(e))return t.get(e);var r={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var n=s?Object.getOwnPropertyDescriptor(e,a):null;n&&(n.get||n.set)?Object.defineProperty(r,a,n):r[a]=e[a]}r.default=e,t&&t.set(e,r)}(ce);var Kr=Ur(_e()),Qr=t;function Xr(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(Xr=function(e){return e?r:t})(e)}Yr=Jr.default=(0,Kr.default)((0,Qr.jsx)("path",{d:"M12 1.27a11 11 0 00-3.48 21.46c.55.09.73-.28.73-.55v-1.84c-3.03.64-3.67-1.46-3.67-1.46-.55-1.29-1.28-1.65-1.28-1.65-.92-.65.1-.65.1-.65 1.1 0 1.73 1.1 1.73 1.1.92 1.65 2.57 1.2 3.21.92a2 2 0 01.64-1.47c-2.47-.27-5.04-1.19-5.04-5.5 0-1.1.46-2.1 1.2-2.84a3.76 3.76 0 010-2.93s.91-.28 3.11 1.1c1.8-.49 3.7-.49 5.5 0 2.1-1.38 3.02-1.1 3.02-1.1a3.76 3.76 0 010 2.93c.83.74 1.2 1.74 1.2 2.94 0 4.21-2.57 5.13-5.04 5.4.45.37.82.92.82 2.02v3.03c0 .27.1.64.73.55A11 11 0 0012 1.27"}),"GitHub");var Zr={},es=n;Object.defineProperty(Zr,"__esModule",{value:!0});var ts=Zr.default=void 0,rs=es(_e()),ss=t;function as(){const e=xe();return t.jsxs(o,{maxWidth:"md",sx:{py:4},children:[t.jsxs(d,{sx:{display:"flex",alignItems:"center",mb:4},children:[t.jsx(c,{startIcon:t.jsx(Qe,{}),onClick:()=>e(-1),sx:{mr:2},children:"Back"}),t.jsx(l,{variant:"h4",component:"h1",children:"About"})]}),t.jsx(i,{elevation:0,sx:{background:e=>s(e.palette.background.paper,.9),backdropFilter:"blur(10px)",borderRadius:2,overflow:"hidden",mb:4},children:t.jsxs(d,{sx:{p:3},children:[t.jsxs(d,{sx:{display:"flex",alignItems:"center",mb:3},children:[t.jsx(Dt,{sx:{mr:2,fontSize:40,color:"primary.main"}}),t.jsxs(d,{children:[t.jsx(l,{variant:"h5",children:"Google Sheets Manager"}),t.jsxs(l,{color:"text.secondary",children:["Version ","1.0.0"]})]})]}),t.jsx(l,{paragraph:!0,children:"A modern web application for managing and working with Google Sheets. Built with React, Material-UI, and the Google Sheets API."})]})}),t.jsx(i,{elevation:0,sx:{background:e=>s(e.palette.background.paper,.9),backdropFilter:"blur(10px)",borderRadius:2,overflow:"hidden",mb:4},children:t.jsxs(d,{sx:{p:3},children:[t.jsx(l,{variant:"h6",gutterBottom:!0,children:"Resources"}),t.jsxs(N,{children:[t.jsxs(G,{component:ne,href:"https://github.com/yourusername/google-sheets-manager",target:"_blank",children:[t.jsx($,{children:t.jsx(Yr,{})}),t.jsx(F,{primary:"GitHub Repository",secondary:"View the source code and contribute"})]}),t.jsx(j,{}),t.jsxs(G,{component:ne,href:"https://developers.google.com/sheets/api",target:"_blank",children:[t.jsx($,{children:t.jsx(Nr,{})}),t.jsx(F,{primary:"Google Sheets API",secondary:"Documentation and guides"})]}),t.jsx(j,{}),t.jsxs(G,{component:ne,href:"#",target:"_blank",children:[t.jsx($,{children:t.jsx(Ve,{})}),t.jsx(F,{primary:"API Documentation",secondary:"Detailed API reference"})]})]})]})}),t.jsx(i,{elevation:0,sx:{background:e=>s(e.palette.background.paper,.9),backdropFilter:"blur(10px)",borderRadius:2,overflow:"hidden"},children:t.jsxs(d,{sx:{p:3},children:[t.jsx(l,{variant:"h6",gutterBottom:!0,children:"Legal & Privacy"}),t.jsxs(N,{children:[t.jsxs(G,{component:ne,href:"#",target:"_blank",children:[t.jsx($,{children:t.jsx(ts,{})}),t.jsx(F,{primary:"Privacy Policy",secondary:"How we handle your data"})]}),t.jsx(j,{}),t.jsxs(G,{component:ne,href:"#",target:"_blank",children:[t.jsx($,{children:t.jsx(Ve,{})}),t.jsx(F,{primary:"Terms of Service",secondary:"Usage terms and conditions"})]})]})]})})]})}ts=Zr.default=(0,rs.default)((0,ss.jsx)("path",{d:"M12 1 3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11z"}),"Security");const ns={html:{height:"100%"},body:{height:"100%",margin:0,padding:0},"#root":{height:"100%",display:"flex",flexDirection:"column"}};fe(document.getElementById("root")).render(t.jsx(ce.StrictMode,{children:t.jsx((function(){return t.jsx(be,{clientId:"343720561747-suv5n74soba9p77r6d32e2sj0bqt7q2t.apps.googleusercontent.com",children:t.jsxs(we,{children:[t.jsx(oe,{}),t.jsx(ie,{styles:ns}),t.jsx(pe,{children:t.jsxs(me,{children:[t.jsx(je,{path:"/",element:t.jsx(Ue,{})}),t.jsx(je,{path:"/home",element:t.jsx(Ue,{})}),t.jsx(je,{path:"/sheets",element:t.jsx(zr,{})}),t.jsx(je,{path:"/sheets/:sheetId",element:t.jsx(zr,{})}),t.jsx(je,{path:"/login",element:t.jsx(Er,{})}),t.jsx(je,{path:"/settings",element:t.jsx(Ar,{})}),t.jsx(je,{path:"/help",element:t.jsx(Vr,{})}),t.jsx(je,{path:"/about",element:t.jsx(as,{})})]})})]})})}),{})}));
